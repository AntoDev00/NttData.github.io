import{a as x,b as ie,c as M,d as ne,e as re,f as oe,g as ae,h as me,i as le,j as se,k as ce,l as de,m as pe,n as ue,o as fe,p as _e,q as Ce,r as ge,s as xe}from"./chunk-2KFCE3JQ.js";import"./chunk-EVKU2CPO.js";import{a as he,b as ve,c as Se}from"./chunk-BC6DZUWT.js";import{Ab as G,Bb as j,Ca as b,Da as w,Ea as E,G as v,Ga as o,H as S,Ha as L,Ia as h,La as I,Ma as T,Tc as te,Va as P,W as l,Xa as F,Yb as $,_,_a as k,aa as D,ac as Q,cc as q,ea as s,ga as c,kb as O,kc as A,lc as J,pa as n,pb as R,qa as r,ra as C,rc as K,s as y,sa as d,sb as N,sc as W,ta as p,tb as B,tc as X,uc as Y,va as U,vb as V,xa as u,xb as z,xc as Z,ya as g,yb as H,yc as ee}from"./chunk-DJCM6767.js";var Ue=()=>[5,10,20],be=(e,t)=>({"active-status":e,"inactive-status":t});function we(e,t){e&1&&(n(0,"div",12),C(1,"mat-spinner",13),r())}function Ee(e,t){e&1&&(n(0,"th",28),o(1," ID "),r())}function ye(e,t){if(e&1&&(n(0,"td",29),o(1),r()),e&2){let i=t.$implicit;l(),h(" ",i.id," ")}}function De(e,t){e&1&&(n(0,"th",28),o(1," Nome "),r())}function Le(e,t){if(e&1&&(n(0,"td",29),o(1),r()),e&2){let i=t.$implicit;l(),h(" ",i.name," ")}}function Ie(e,t){e&1&&(n(0,"th",28),o(1," Email "),r())}function Te(e,t){if(e&1&&(n(0,"td",29),o(1),r()),e&2){let i=t.$implicit;l(),h(" ",i.email," ")}}function Pe(e,t){e&1&&(n(0,"th",28),o(1," Genere "),r())}function Fe(e,t){if(e&1&&(n(0,"td",29),o(1),r()),e&2){let i=t.$implicit;l(),h(" ",i.gender," ")}}function ke(e,t){e&1&&(n(0,"th",28),o(1," Stato "),r())}function Oe(e,t){if(e&1&&(n(0,"td",29)(1,"span",30),o(2),r()()),e&2){let i=t.$implicit;l(),c("ngClass",T(2,be,i.status==="active",i.status==="inactive")),l(),L(i.status)}}function Re(e,t){e&1&&(n(0,"th",31),o(1," Azioni "),r())}function Ne(e,t){if(e&1){let i=U();n(0,"td",29)(1,"button",32),u("click",function(){let a=v(i).$implicit,f=g(2);return S(f.viewUserDetails(a.id))}),n(2,"mat-icon"),o(3,"visibility"),r()(),n(4,"button",33),u("click",function(){let a=v(i).$implicit,f=g(2);return S(f.deleteUser(a.id))}),n(5,"mat-icon"),o(6,"delete"),r()()()}}function Be(e,t){e&1&&C(0,"tr",34)}function Ve(e,t){e&1&&C(0,"tr",35)}function ze(e,t){e&1&&(n(0,"tr",36)(1,"td",37),o(2,"Nessun utente trovato"),r()())}function He(e,t){if(e&1){let i=U();n(0,"div")(1,"table",14),d(2,15),s(3,Ee,2,0,"th",16)(4,ye,2,1,"td",17),p(),d(5,18),s(6,De,2,0,"th",16)(7,Le,2,1,"td",17),p(),d(8,19),s(9,Ie,2,0,"th",16)(10,Te,2,1,"td",17),p(),d(11,20),s(12,Pe,2,0,"th",16)(13,Fe,2,1,"td",17),p(),d(14,21),s(15,ke,2,0,"th",16)(16,Oe,3,5,"td",17),p(),d(17,22),s(18,Re,2,0,"th",23)(19,Ne,7,0,"td",17),p(),s(20,Be,1,0,"tr",24)(21,Ve,1,0,"tr",25)(22,ze,3,0,"tr",26),r(),n(23,"mat-paginator",27),u("page",function(a){v(i);let f=g();return S(f.onPageChange(a))}),r()()}if(e&2){let i=g();l(),c("dataSource",i.dataSource),l(19),c("matHeaderRowDef",i.displayedColumns),l(),c("matRowDefColumns",i.displayedColumns),l(2),c("pageSizeOptions",I(5,Ue))("pageSize",20)}}var Me=class e{constructor(t,i,m,a,f){this.userService=t;this.fb=i;this.dialog=m;this.snackBar=a;this.router=f}users=[];dataSource=new ge([]);displayedColumns=["id","name","email","gender","status","actions"];searchForm;loading=!1;totalUsers=0;perPage=20;paginator;sort;ngOnInit(){this.initSearchForm(),this.loadUsers()}initSearchForm(){this.searchForm=this.fb.group({name:[""],email:[""]})}loadUsers(t=1){let{name:i,email:m}=this.searchForm.value;this.loading=!0,this.userService.getUsers(t,this.perPage,i,m).pipe(y(()=>this.loading=!1)).subscribe({next:a=>{this.users=a,this.dataSource.data=a,setTimeout(()=>{this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort})},error:a=>{console.error("Errore nel caricamento degli utenti",a),this.snackBar.open("Errore nel caricamento degli utenti","Chiudi",{duration:3e3})}})}onSearch(){this.loadUsers()}resetSearch(){this.searchForm.reset(),this.loadUsers()}viewUserDetails(t){this.router.navigate(["/users",t])}createUser(){}deleteUser(t){confirm("Sei sicuro di voler eliminare questo utente?")&&this.userService.deleteUser(t).subscribe({next:()=>{this.snackBar.open("Utente eliminato con successo","Chiudi",{duration:3e3}),this.loadUsers()},error:i=>{console.error("Errore durante l'eliminazione dell'utente",i),this.snackBar.open("Errore durante l'eliminazione dell'utente","Chiudi",{duration:3e3})}})}onPageChange(t){this.loadUsers(t.pageIndex+1)}static \u0275fac=function(i){return new(i||e)(_(Se),_(G),_(xe),_(te),_(O))};static \u0275cmp=D({type:e,selectors:[["app-user-list"]],viewQuery:function(i,m){if(i&1&&(b(x,5),b(M,5)),i&2){let a;w(a=E())&&(m.paginator=a.first),w(a=E())&&(m.sort=a.first)}},decls:30,vars:3,consts:[[1,"search-form",3,"ngSubmit","formGroup"],[1,"search-fields"],["appearance","outline"],["matInput","","formControlName","name","placeholder","Cerca per nome"],["matInput","","formControlName","email","placeholder","Cerca per email"],[1,"search-buttons"],["mat-raised-button","","color","primary","type","submit"],["mat-button","","type","button",3,"click"],[1,"add-user-button"],["mat-raised-button","","color","accent",3,"click"],["class","loading-spinner",4,"ngIf"],[4,"ngIf"],[1,"loading-spinner"],["diameter","40"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","email"],["matColumnDef","gender"],["matColumnDef","status"],["matColumnDef","actions"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["showFirstLastButtons","",3,"page","pageSizeOptions","pageSize"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"ngClass"],["mat-header-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","6",1,"mat-cell"]],template:function(i,m){i&1&&(n(0,"h1"),o(1,"Gestione Utenti"),r(),n(2,"p"),o(3,"Visualizza, cerca, crea e gestisci gli utenti"),r(),n(4,"form",0),u("ngSubmit",function(){return m.onSearch()}),n(5,"div",1)(6,"mat-form-field",2)(7,"mat-label"),o(8,"Nome"),r(),C(9,"input",3),r(),n(10,"mat-form-field",2)(11,"mat-label"),o(12,"Email"),r(),C(13,"input",4),r(),n(14,"div",5)(15,"button",6)(16,"mat-icon"),o(17,"search"),r(),o(18," Cerca "),r(),n(19,"button",7),u("click",function(){return m.resetSearch()}),n(20,"mat-icon"),o(21,"clear"),r(),o(22," Reset "),r()()()(),n(23,"div",8)(24,"button",9),u("click",function(){return m.createUser()}),n(25,"mat-icon"),o(26,"add"),r(),o(27," Nuovo Utente "),r()(),s(28,we,2,0,"div",10)(29,He,24,6,"div",11)),i&2&&(l(4),c("formGroup",m.searchForm),l(24),c("ngIf",m.loading),l(),c("ngIf",!m.loading))},dependencies:[k,P,F,j,V,R,N,B,z,H,q,Q,$,A,W,K,J,Y,X,ee,Z,ie,x,ve,he,re,M,ne,Ce,oe,me,de,le,ae,pe,se,ce,ue,fe,_e],styles:[".user-list-container[_ngcontent-%COMP%]{padding:20px}.search-form[_ngcontent-%COMP%]{margin-bottom:20px}.search-fields[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px;align-items:center}.search-buttons[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:10px}.add-user-button[_ngcontent-%COMP%]{margin-bottom:20px;display:flex;justify-content:flex-end}.loading-spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:40px 0}.users-table-container[_ngcontent-%COMP%]{max-height:600px;overflow:auto}table[_ngcontent-%COMP%]{width:100%}.mat-column-actions[_ngcontent-%COMP%]{width:120px;text-align:center}.active-status[_ngcontent-%COMP%]{color:green;font-weight:500}.inactive-status[_ngcontent-%COMP%]{color:red;font-weight:500}@media (max-width: 768px){.search-fields[_ngcontent-%COMP%]{flex-direction:column;gap:0;width:100%}mat-form-field[_ngcontent-%COMP%]{width:100%}}"]})};export{Me as UserListComponent};
